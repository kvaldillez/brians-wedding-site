<h1>RSVP</h1>
<h2>We Hope You Will Be Able To Join Us</h2>
<p>Please RSVP below and select your entree of choice, the selections are listed below for reference:</p>

<ul>
  <li>Sun-Dried Tomato Chicken</li>
  <li>Chimichurri Flank Steak</li>
  <li>Soy-Glazed Salmon</li>
  <li>Stuffed Bell Peppers (Vegetarian)</li>
</ul>

<!--<button class="btn btn-primary" (click)="redirectToThankYou()">RSVP</button>-->

<p>
  Please enter the main name on the invitation below, and then select a number of guests within your party (if applicable). Be sure to make your food selections as well.
</p>
<form (ngSubmit)="checkRsvp()" #f="ngForm">
    <ul id="warning">
        <li *ngIf="!firstName.valid && firstName.touched"><span class="error">Please enter a valid first name.</span></li>
        <li *ngIf="!lastName.valid && lastName.touched"><span class="error">Please enter a valid last name.</span></li>
    </ul>
    <div class="row">
        <div class="form-group col-md-6">
            <h3><label for="firstName">First Name</label></h3>
            <input type="text" name="firstName" value="" ngModel required #firstName="ngModel">
        </div>
        <div class="form-group col-md-6">
            <h3><label for="email">Last Name</label></h3>
            <input type="text" name="lastName" value="" ngModel required #lastName="ngModel">
        </div>
    </div>
    <input class="submit fr" type="submit" value="Search for my invitation" [disabled]="!f.valid">
</form>

<hr />
<div *ngIf="submitted">
  <form #fs="ngForm" *ngIf="!responded && foundRsvp" (ngSubmit)="onSubmit()">
      <ul id="warning">
          <!--<li *ngIf="!mealSelection.valid && mealSelection.touched"><span class="error">Please select a meal.</span></li>-->
      </ul>
        <div class="row" *ngFor="let person of guests, let i = index">
          <div ngModelGroup="{{ i }}">
          <div class="col-md-4">
            <h4>{{ person.firstName }} {{ person.lastName }}</h4>
            <input type="hidden" name="firstName" ngModel="{{ person.firstName }}" #firstName="ngModel" required />
            <input type="hidden" name="lastName" ngModel="{{ person.lastName }}" #lastName="ngModel" required />
          </div>
          <div class="col-md-4">
            <label for="rsvpSelection"><strong>RSVP:</strong></label>
            <select name="rsvpSelection" ngModel required #rsvpSelection="ngModel">
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>
          <div class="col-md-4">
              <label for="mealSelection"><strong>Meal Selection:</strong></label>
              <select name="mealSelection" ngModel required #mealSelection="ngModel">
                <option value="Sun-Dried Tomato Chicken">Sun-Dried Tomato Chicken</option>
                <option value="Chimichurri Flank Steak">Chimichurri Flank Steak</option>
                <option value="Soy-Glazed Salmon">Soy-Glazed Salmon</option>
                <option value="Stuffed Bell Peppers (Vegetarian)">Stuffed Bell Peppers (Vegetarian)</option>
              </select>
          </div>
        </div>
        </div>
      <input class="submit fr" type="submit" value="Submit my RSVP" [disabled]="!fs.valid">
  </form>
</div>
<div class="row" *ngIf="submitted">
  <div class="col-xs-12" *ngIf="success">
      <h3>Thanks for RSVPing, we can't wait to see you!</h3>
      <p>For reference, you submitted a RSVP for {{ user.firstName }} {{ user.lastName }} and you'd like to have the {{ user.mealSelection }} for dinner.</p>
  </div>
  <div class="col-xs-12" *ngIf="responded && foundRsvp">
      <h3>It looks like you have responded already</h3>
      <p>You or someone in your party has already RSVPed. Here are your responses below:</p>
      <ul class="guests">
        <li *ngFor="let person of guests">
          <h4>{{ person.firstName }} {{ person.lastName }}</h4><strong>RSVP:</strong> {{ person.rsvp }}<span *ngIf="person.rsvp == 'Yes'"><br /><strong>Meal Selection:</strong> {{ person.mealSelection }}</span>
        </li>
      </ul>
  </div>
  <div class="col-xs-12" *ngIf="!foundRsvp">
      <h3>Sorry, we were unable to find your invitation!</h3>
      <p>Please you the contact form to reach out to us if you think there has been a mistake and we will get back to you as soon as possible. Thank you for your patience!</p>
  </div>
</div>
